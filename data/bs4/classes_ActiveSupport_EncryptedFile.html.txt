NamespaceCLASSActiveSupport::EncryptedFile::InvalidKeyLengthErrorCLASSActiveSupport::EncryptedFile::MissingContentErrorCLASSActiveSupport::EncryptedFile::MissingKeyErrorMethodsCchangeGgenerate_keyKkey,key?NnewRreadWwriteConstantsCIPHER="aes-128-gcm"Attributes[R]content_path[R]env_key[R]key_path[R]raise_if_missing_keyClass Public methodsgenerate_key()LinkSource:show|on GitHub# File activesupport/lib/active_support/encrypted_file.rb, line 31defself.generate_keySecureRandom.hex(ActiveSupport::MessageEncryptor.key_len(CIPHER))endnew(content_path:, key_path:, env_key:, raise_if_missing_key:)LinkSource:show|on GitHub# File activesupport/lib/active_support/encrypted_file.rb, line 42definitialize(content_path:,key_path:,env_key:,raise_if_missing_key:)@content_path=Pathname.new(content_path).yield_self{|path|path.symlink??path.realpath:path}@key_path=Pathname.new(key_path)@env_key,@raise_if_missing_key=env_key,raise_if_missing_keyendInstance Public methodschange(&block)LinkSource:show|on GitHub# File activesupport/lib/active_support/encrypted_file.rb, line 83defchange(&block)writingread,&blockendkey()LinkReturns the encryption key, first trying the environment variable specified byenv_key, then trying the key file specified bykey_path. Ifraise_if_missing_keyis true, raisesMissingKeyErrorif the environment variable is not set and the key file does not exist.Source:show|on GitHub# File activesupport/lib/active_support/encrypted_file.rb, line 52defkeyread_env_key||read_key_file||handle_missing_keyendkey?()LinkReturns truthy ifkeyis truthy. Returns falsy otherwise. Unlikekey, does not raiseMissingKeyErrorwhenraise_if_missing_keyis true.Source:show|on GitHub# File activesupport/lib/active_support/encrypted_file.rb, line 58defkey?read_env_key||read_key_fileendread()LinkReads the file and returns the decrypted content.Raises:MissingKeyErrorif the key is missing andraise_if_missing_keyis true.MissingContentErrorif the encrypted file does not exist or otherwise if the key is missing.ActiveSupport::MessageEncryptor::InvalidMessageif the content cannot be decrypted or verified.Source:show|on GitHub# File activesupport/lib/active_support/encrypted_file.rb, line 70defreadif!key.nil?&&content_path.exist?decryptcontent_path.binreadelseraiseMissingContentError,content_pathendendwrite(contents)LinkSource:show|on GitHub# File activesupport/lib/active_support/encrypted_file.rb, line 78defwrite(contents)IO.binwrite"#{content_path}.tmp",encrypt(contents)FileUtils.mv"#{content_path}.tmp",content_pathend