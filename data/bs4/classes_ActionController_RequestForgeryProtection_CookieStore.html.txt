MethodsFfetchNnewRresetSstoreClass Public methodsnew(cookie = :csrf_token)LinkSource:show|on GitHub# File actionpack/lib/action_controller/metal/request_forgery_protection.rb, line 332definitialize(cookie=:csrf_token)@cookie_name=cookieendInstance Public methodsfetch(request)LinkSource:show|on GitHub# File actionpack/lib/action_controller/metal/request_forgery_protection.rb, line 336deffetch(request)contents=request.cookie_jar.encrypted[@cookie_name]returnnilifcontents.nil?value=JSON.parse(contents)returnnilunlessvalue.dig("session_id","public_id")==request.session.id_was&.public_idvalue["token"]rescueJSON::ParserErrornilendreset(request)LinkSource:show|on GitHub# File actionpack/lib/action_controller/metal/request_forgery_protection.rb, line 359defreset(request)request.cookie_jar.delete(@cookie_name)endstore(request, csrf_token)LinkSource:show|on GitHub# File actionpack/lib/action_controller/metal/request_forgery_protection.rb, line 348defstore(request,csrf_token)request.cookie_jar.encrypted.permanent[@cookie_name] = {value:{token:csrf_token,session_id:request.session.id,
    }.to_json,httponly:true,same_site::lax,
  }end