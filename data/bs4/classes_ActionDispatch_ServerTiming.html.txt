MethodsCcallNnewClass Public methodsnew(app)LinkSource:show|on GitHub# File actionpack/lib/action_dispatch/middleware/server_timing.rb, line 52definitialize(app)@app=app@subscriber=Subscriber.instance@subscriber.ensure_subscribedendInstance Public methodscall(env)LinkSource:show|on GitHub# File actionpack/lib/action_dispatch/middleware/server_timing.rb, line 58defcall(env)response=nilevents=@subscriber.collect_eventsdoresponse=@app.call(env)endheaders=response[1]header_info=events.group_by(&:name).mapdo|event_name,events_collection|"%s;dur=%.2f"%[event_name,events_collection.sum(&:duration)]endifheaders[ActionDispatch::Constants::SERVER_TIMING].present?header_info.prepend(headers[ActionDispatch::Constants::SERVER_TIMING])endheaders[ActionDispatch::Constants::SERVER_TIMING] =header_info.join(", ")responseend