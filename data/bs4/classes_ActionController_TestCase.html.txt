Action Controller Test CaseSuperclass forActionControllerfunctional tests. Functional tests allow you to test a single controller action per test method.Use integration style controller tests over functional style controller tests.Railsdiscourages the use of functional tests in favor of integration tests (useActionDispatch::IntegrationTest).NewRailsapplications no longer generate functional style controller tests and they should only be used for backward compatibility. Integration style controller tests perform actual requests, whereas functional style controller tests merely simulate a request. Besides, integration tests are as fast as functional tests and provide lot of helpers such asas,parsed_bodyfor effective testing of controller actions including evenAPIendpoints.Basic exampleFunctional tests are written as follows: 1. First, one uses theget,post,patch,put,delete, orheadmethod to simulate an HTTP request. 2. Then, one asserts whether the current state is as expected. âStateâ can be anything: the controllerâs HTTP response, the database contents, etc.For example:class BooksControllerTest < ActionController::TestCase
  def test_create
    # Simulate a POST response with the given HTTP parameters.
    post(:create, params: { book: { title: "Love Hina" }})

    # Asserts that the controller tried to redirect us to
    # the created book's URI.
    assert_response :found

    # Asserts that the controller really put the book in the database.
    assert_not_nil Book.find_by(title: "Love Hina")
  end
endYou can also send a real document in the simulated HTTP request.def test_create
  json = {book: { title: "Love Hina" }}.to_json
  post :create, body: json
endSpecial instance variablesActionController::TestCasewill also automatically provide the following instance variables for use in the tests:@controllerThe controller instance that will be tested.@requestAn ActionController::TestRequest, representing the current HTTP request. You can modify this object before sending the HTTP request. For example, you might want to set some session properties before sending a GET request.@responseAnActionDispatch::TestResponseobject, representing the response of the last HTTP response. In the above example,@responsebecomes valid after callingpost. If the various assert methods are not sufficient, then you may use this object to inspect the HTTP response in detail.Controller is automatically inferredActionController::TestCasewill automatically infer the controller under test from the test class name. If the controller cannot be inferred from the test class name, you can explicitly set it withtests.class SpecialEdgeCaseWidgetsControllerTest < ActionController::TestCase
  tests WidgetController
endTestingcontroller internalsIn addition to these specific assertions, you also have easy access to various collections that the regular test/unit assertions can be used against. These collections are:session: Objects being saved in the session.flash: The flash objects currently in the session.cookies:Cookiesbeing sent to the user on this request.These collections can be used just like any other hash:assert_equal "Dave", cookies[:name] # makes sure that a cookie called :name was set as "Dave"
assert flash.empty? # makes sure that there's nothing in the flashOn top of the collections, you have the complete URL that a given action redirected to available inredirect_to_url.For redirects within the same controller, you can even call follow_redirect and the redirect will be followed, triggering another action call which can then be asserted against.Manipulating session and cookie variablesSometimes you need to set up the session and cookie variables for a test. To do this just assign a value to the session or cookie collection:session[:key] = "value"
cookies[:key] = "value"To clear the cookies for a test just clear the cookie collection:cookies.clearTestingnamed routesIf youâre using named routes, they can be easily tested using the original named routesâ methods straight in the test case.assert_redirected_to page_url(title: 'foo')NamespaceMODULEActionController::TestCase::BehaviorIncluded ModulesActionController::TestCase::BehaviorAttributes[RW]executor_around_each_request