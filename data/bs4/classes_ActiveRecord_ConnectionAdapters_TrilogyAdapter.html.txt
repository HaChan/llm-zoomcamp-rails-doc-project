MethodsAactive?Cconnected?Ddiscard!,disconnect!Nnew,new_clientPparse_ssl_modeSsavepoint_errors_invalidate_transactions?,supports_comments?,supports_comments_in_create?,supports_json?,supports_lazy_transactions?,supports_savepoints?Ttranslate_connect_errorIncluded ModulesActiveRecord::ConnectionAdapters::Trilogy::DatabaseStatementsConstantsADAPTER_NAME="Trilogy"ER_ACCESS_DENIED_ERROR=1045ER_BAD_DB_ERROR=1049ER_DBACCESS_DENIED_ERROR=1044SSL_MODES={
SSL_MODE_DISABLED: ::Trilogy::SSL_DISABLED,
SSL_MODE_PREFERRED: ::Trilogy::SSL_PREFERRED_NOVERIFY,
SSL_MODE_REQUIRED: ::Trilogy::SSL_REQUIRED_NOVERIFY,
SSL_MODE_VERIFY_CA: ::Trilogy::SSL_VERIFY_CA,
SSL_MODE_VERIFY_IDENTITY: ::Trilogy::SSL_VERIFY_IDENTITY
}.freezeTYPE_MAP=Type::TypeMap.new.tap { |m| initialize_type_map(m) }Class Public methodsnew(config, *)LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/trilogy_adapter.rb, line 75definitialize(config,*)config=config.dup# Trilogy ignores `socket` if `host is set. We want the opposite to allow# configuring UNIX domain sockets via `DATABASE_URL`.config.delete(:host)ifconfig[:socket]# Set FOUND_ROWS capability on the connection so UPDATE queries returns number of rows# matched rather than number of rows updated.config[:found_rows] =trueifconfig[:prepared_statements]raiseArgumentError,"Trilogy currently doesn't support prepared statements. Remove `prepared_statements: true` from your database configuration."endsuperendnew_client(config)LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/trilogy_adapter.rb, line 30defnew_client(config)config[:ssl_mode] =parse_ssl_mode(config[:ssl_mode])ifconfig[:ssl_mode]::Trilogy.new(config)rescue::Trilogy::Error=>errorraisetranslate_connect_error(config,error)endparse_ssl_mode(mode)LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/trilogy_adapter.rb, line 37defparse_ssl_mode(mode)returnmodeifmode.is_a?Integerm=mode.to_s.upcasem="SSL_MODE_#{m}"unlessm.start_with?"SSL_MODE_"SSL_MODES.fetch(m.to_sym,mode)endtranslate_connect_error(config, error)LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/trilogy_adapter.rb, line 46deftranslate_connect_error(config,error)caseerror.error_codewhenER_DBACCESS_DENIED_ERROR,ER_BAD_DB_ERRORActiveRecord::NoDatabaseError.db_error(config[:database])whenER_ACCESS_DENIED_ERRORActiveRecord::DatabaseConnectionError.username_error(config[:username])elseiferror.message.include?("TRILOGY_DNS_ERROR")ActiveRecord::DatabaseConnectionError.hostname_error(config[:host])elseActiveRecord::ConnectionNotEstablished.new(error.message)endendendInstance Public methodsactive?()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/trilogy_adapter.rb, line 123defactive?connected?&&@lock.synchronize{@raw_connection&.ping}||falserescue::Trilogy::Errorfalseendconnected?()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/trilogy_adapter.rb, line 119defconnected?!(@raw_connection.nil?||@raw_connection.closed?)enddiscard!()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/trilogy_adapter.rb, line 139defdiscard!@lock.synchronizedosuper@raw_connection&.discard!@raw_connection=nilendenddisconnect!()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/trilogy_adapter.rb, line 131defdisconnect!@lock.synchronizedosuper@raw_connection&.close@raw_connection=nilendendsavepoint_errors_invalidate_transactions?()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/trilogy_adapter.rb, line 111defsavepoint_errors_invalidate_transactions?trueendsupports_comments?()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/trilogy_adapter.rb, line 99defsupports_comments?trueendsupports_comments_in_create?()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/trilogy_adapter.rb, line 103defsupports_comments_in_create?trueendsupports_json?()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/trilogy_adapter.rb, line 95defsupports_json?!mariadb?&&database_version>="5.7.8"endsupports_lazy_transactions?()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/trilogy_adapter.rb, line 115defsupports_lazy_transactions?trueendsupports_savepoints?()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/trilogy_adapter.rb, line 107defsupports_savepoints?trueend