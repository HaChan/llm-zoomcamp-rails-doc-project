MethodsCcharset,check_constraints,collation,create_database,current_databaseDdbconsole,drop_tableEemulate_booleansFforeign_keysIindex_algorithmsNnative_database_typesQquote_stringRrecreate_database,rename_index,rename_tableSshow_variable,strict_mode?,supports_advisory_locks?,supports_bulk_alter?,supports_check_constraints?,supports_common_table_expressions?,supports_datetime_with_precision?,supports_explain?,supports_expression_index?,supports_foreign_keys?,supports_index_sort_order?,supports_indexes_in_create?,supports_insert_on_duplicate_skip?,supports_insert_on_duplicate_update?,supports_insert_returning?,supports_optimizer_hints?,supports_restart_db_transaction?,supports_transaction_isolation?,supports_views?,supports_virtual_columns?Included ModulesActiveRecord::ConnectionAdapters::MySQL::DatabaseStatementsConstantsCR_SERVER_GONE_ERROR=2006CR_SERVER_LOST=2013EMULATE_BOOLEANS_TRUE={ emulate_booleans: true }.freezeER_CANNOT_ADD_FOREIGN=1215ER_CANNOT_CREATE_TABLE=1005ER_CLIENT_INTERACTION_TIMEOUT=4031ER_CONNECTION_KILLED=1927ER_DATA_TOO_LONG=1406ER_DB_CREATE_EXISTS=1007Seedev.mysql.com/doc/mysql-errors/en/server-error-reference.htmlER_DO_NOT_HAVE_DEFAULT=1364ER_DUP_ENTRY=1062ER_FILSORT_ABORT=1028ER_FK_INCOMPATIBLE_COLUMNS=3780ER_LOCK_DEADLOCK=1213ER_LOCK_WAIT_TIMEOUT=1205ER_NOT_NULL_VIOLATION=1048ER_NO_REFERENCED_ROW=1216ER_NO_REFERENCED_ROW_2=1452ER_OUT_OF_RANGE=1264ER_QUERY_INTERRUPTED=1317ER_QUERY_TIMEOUT=3024ER_ROW_IS_REFERENCED=1217ER_ROW_IS_REFERENCED_2=1451ER_SERVER_SHUTDOWN=1053EXTENDED_TYPE_MAPS=Concurrent::Map.newNATIVE_DATABASE_TYPES={
primary_key: "bigint auto_increment PRIMARY KEY",
string:      { name: "varchar", limit: 255 },
text:        { name: "text" },
integer:     { name: "int", limit: 4 },
bigint:      { name: "bigint" },
float:       { name: "float", limit: 24 },
decimal:     { name: "decimal" },
datetime:    { name: "datetime" },
timestamp:   { name: "timestamp" },
time:        { name: "time" },
date:        { name: "date" },
binary:      { name: "blob" },
blob:        { name: "blob" },
boolean:     { name: "tinyint", limit: 1 },
json:        { name: "json" },
}Class Public methodsdbconsole(config, options = {})LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 57defdbconsole(config,options= {})mysql_config=config.configuration_hashargs= {host:"--host",port:"--port",socket:"--socket",username:"--user",encoding:"--default-character-set",sslca:"--ssl-ca",sslcert:"--ssl-cert",sslcapath:"--ssl-capath",sslcipher:"--ssl-cipher",sslkey:"--ssl-key",ssl_mode:"--ssl-mode"}.filter_map{|opt,arg|"#{arg}=#{mysql_config[opt]}"ifmysql_config[opt] }ifmysql_config[:password]&&options[:include_password]args<<"--password=#{mysql_config[:password]}"elsifmysql_config[:password]&&!mysql_config[:password].to_s.empty?args<<"-p"endargs<<config.databasefind_cmd_and_exec(["mysql","mysql5"],*args)endemulate_booleansLinkBy default, theMysql2Adapterwill consider all columns of typetinyint(1)as boolean. If you wish to disable this emulation you can add the following line to your application.rb file:ActiveRecord::ConnectionAdapters::Mysql2Adapter.emulate_booleans = falseSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 29class_attribute:emulate_booleans,default:trueInstance Public methodscharset()LinkReturns the database character set.Source:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 308defcharsetshow_variable"character_set_database"endcheck_constraints(table_name)LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 513defcheck_constraints(table_name)ifsupports_check_constraints?scope=quoted_scope(table_name)sql=<<~SQLSELECT cc.constraint_name AS 'name',
                  cc.check_clause AS 'expression'
            FROM information_schema.check_constraints cc
            JOIN information_schema.table_constraints tc
            USING (constraint_schema, constraint_name)
            WHERE tc.table_schema = #{scope[:schema]}
              AND tc.table_name = #{scope[:name]}
              AND cc.constraint_schema = #{scope[:schema]}SQLsql+=" AND cc.table_name = #{scope[:name]}"ifmariadb?chk_info=internal_exec_query(sql,"SCHEMA")chk_info.mapdo|row|options= {name:row["name"]
            }expression=row["expression"]expression=expression[1..-2]ifexpression.start_with?("(")&&expression.end_with?(")")expression=strip_whitespace_characters(expression)unlessmariadb?# MySQL returns check constraints expression in an already escaped form.# This leads to duplicate escaping later (e.g. when the expression is used in the SchemaDumper).expression=expression.gsub("\\'","'")endCheckConstraintDefinition.new(table_name,expression,options)endelseraiseNotImplementedErrorendendcollation()LinkReturns the database collation strategy.Source:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 313defcollationshow_variable"collation_database"endcreate_database(name, options = {})LinkCreate a newMySQLdatabase with optional:charsetand:collation. Charset defaults to utf8mb4.Example:create_database 'charset_test', charset: 'latin1', collation: 'latin1_bin'
create_database 'matt_development'
create_database 'matt_development', charset: :big5Source:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 283defcreate_database(name,options= {})ifoptions[:collation]execute"CREATE DATABASE #{quote_table_name(name)} DEFAULT COLLATE #{quote_table_name(options[:collation])}"elsifoptions[:charset]execute"CREATE DATABASE #{quote_table_name(name)} DEFAULT CHARACTER SET #{quote_table_name(options[:charset])}"elsifrow_format_dynamic_by_default?execute"CREATE DATABASE #{quote_table_name(name)} DEFAULT CHARACTER SET `utf8mb4`"elseraise"Configure a supported :charset and ensure innodb_large_prefix is enabled to support indexes on varchar(255) string columns."endendcurrent_database()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 303defcurrent_databasequery_value("SELECT database()","SCHEMA")enddrop_table(table_name, **options)LinkDrops a table from the database.:forceSet to:cascadeto drop dependent objects as well. Defaults to false.:if_existsSet totrueto only drop the table if it exists. Defaults to false.:temporarySet totrueto drop temporary table. Defaults to false.Although this command ignores mostoptionsand the block if one is given, it can be helpful to provide these in a migrationâschangemethod so it can be reverted. In that case,optionsand the block will be used by create_table.Source:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 361defdrop_table(table_name,**options)schema_cache.clear_data_source_cache!(table_name.to_s)execute"DROP#{' TEMPORARY' if options[:temporary]} TABLE#{' IF EXISTS' if options[:if_exists]} #{quote_table_name(table_name)}#{' CASCADE' if options[:force] == :cascade}"endforeign_keys(table_name)LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 468defforeign_keys(table_name)raiseArgumentErrorunlesstable_name.present?scope=quoted_scope(table_name)# MySQL returns 1 row for each column of composite foreign keys.fk_info=internal_exec_query(<<~SQL,"SCHEMA")SELECT fk.referenced_table_name AS 'to_table',
                 fk.referenced_column_name AS 'primary_key',
                 fk.column_name AS 'column',
                 fk.constraint_name AS 'name',
                 fk.ordinal_position AS 'position',
                 rc.update_rule AS 'on_update',
                 rc.delete_rule AS 'on_delete'
          FROM information_schema.referential_constraints rc
          JOIN information_schema.key_column_usage fk
          USING (constraint_schema, constraint_name)
          WHERE fk.referenced_column_name IS NOT NULL
            AND fk.table_schema = #{scope[:schema]}
            AND fk.table_name = #{scope[:name]}
            AND rc.constraint_schema = #{scope[:schema]}
            AND rc.table_name = #{scope[:name]}SQLgrouped_fk=fk_info.group_by{|row|row["name"] }.values.each{|group|group.sort_by!{|row|row["position"] } }grouped_fk.mapdo|group|row=group.firstoptions= {name:row["name"],on_update:extract_foreign_key_action(row["on_update"]),on_delete:extract_foreign_key_action(row["on_delete"])
          }ifgroup.one?options[:column] =unquote_identifier(row["column"])options[:primary_key] =row["primary_key"]elseoptions[:column] =group.map{|row|unquote_identifier(row["column"]) }options[:primary_key] =group.map{|row|row["primary_key"] }endForeignKeyDefinition.new(table_name,unquote_identifier(row["to_table"]),options)endendindex_algorithms()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 189defindex_algorithms{default:"ALGORITHM = DEFAULT",copy:"ALGORITHM = COPY",inplace:"ALGORITHM = INPLACE",instant:"ALGORITHM = INSTANT",
  }endnative_database_types()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 185defnative_database_typesNATIVE_DATABASE_TYPESendquote_string(string)LinkQuotes strings for use in SQL input.Source:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 692defquote_string(string)with_raw_connection(allow_retry:true,materialize_transactions:false)do|connection|connection.escape(string)endendrecreate_database(name, options = {})LinkDrops the database specified on thenameattribute and creates it again using the providedoptions.Source:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 269defrecreate_database(name,options= {})drop_database(name)sql=create_database(name,options)reconnect!sqlendrename_index(table_name, old_name, new_name)LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 366defrename_index(table_name,old_name,new_name)ifsupports_rename_index?validate_index_length!(table_name,new_name)execute"ALTER TABLE #{quote_table_name(table_name)} RENAME INDEX #{quote_table_name(old_name)} TO #{quote_table_name(new_name)}"elsesuperendendrename_table(table_name, new_name, **options)LinkRenames a table.Example:rename_table('octopuses', 'octopi')Source:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 338defrename_table(table_name,new_name,**options)validate_table_length!(new_name)unlessoptions[:_uses_legacy_table_name]schema_cache.clear_data_source_cache!(table_name.to_s)schema_cache.clear_data_source_cache!(new_name.to_s)execute"RENAME TABLE #{quote_table_name(table_name)} TO #{quote_table_name(new_name)}"rename_table_indexes(table_name,new_name,**options)endshow_variable(name)LinkSHOW VARIABLES LIKE ânameâSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 582defshow_variable(name)query_value("SELECT @@#{name}","SCHEMA")rescueActiveRecord::StatementInvalidnilendstrict_mode?()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 633defstrict_mode?self.class.type_cast_config_to_boolean(@config.fetch(:strict,true))endsupports_advisory_locks?()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 161defsupports_advisory_locks?trueendsupports_bulk_alter?()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 96defsupports_bulk_alter?trueendsupports_check_constraints?()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 128defsupports_check_constraints?ifmariadb?database_version>="10.3.10"||(database_version<"10.3"&&database_version>="10.2.22")elsedatabase_version>="8.0.16"endendsupports_common_table_expressions?()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 153defsupports_common_table_expressions?ifmariadb?database_version>="10.2.1"elsedatabase_version>="8.0.1"endendsupports_datetime_with_precision?()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 140defsupports_datetime_with_precision?mariadb?||database_version>="5.6.4"endsupports_explain?()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 116defsupports_explain?trueendsupports_expression_index?()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 104defsupports_expression_index?!mariadb?&&database_version>="8.0.13"endsupports_foreign_keys?()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 124defsupports_foreign_keys?trueendsupports_index_sort_order?()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 100defsupports_index_sort_order?!mariadb?&&database_version>="8.0.1"endsupports_indexes_in_create?()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 120defsupports_indexes_in_create?trueendsupports_insert_on_duplicate_skip?()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 165defsupports_insert_on_duplicate_skip?trueendsupports_insert_on_duplicate_update?()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 169defsupports_insert_on_duplicate_update?trueendsupports_insert_returning?()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 173defsupports_insert_returning?mariadb?&&database_version>="10.5.0"endsupports_optimizer_hints?()LinkSeedev.mysql.com/doc/refman/en/optimizer-hints.htmlfor more details.Source:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 149defsupports_optimizer_hints?!mariadb?&&database_version>="5.7.7"endsupports_restart_db_transaction?()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 112defsupports_restart_db_transaction?trueendsupports_transaction_isolation?()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 108defsupports_transaction_isolation?trueendsupports_views?()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 136defsupports_views?trueendsupports_virtual_columns?()LinkSource:show|on GitHub# File activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb, line 144defsupports_virtual_columns?mariadb?||database_version>="5.7.5"end