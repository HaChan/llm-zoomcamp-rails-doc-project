MethodsCcallNnewClass Public methodsnew(app)LinkSource:show|on GitHub# File actionpack/lib/action_dispatch/http/content_security_policy.rb, line 31definitialize(app)@app=appendInstance Public methodscall(env)LinkSource:show|on GitHub# File actionpack/lib/action_dispatch/http/content_security_policy.rb, line 35defcall(env)status,headers,_=response=@app.call(env)# Returning CSP headers with a 304 Not Modified is harmful, since nonces in the# new CSP headers might not match nonces in the cached HTML.returnresponseifstatus==304returnresponseifpolicy_present?(headers)request=ActionDispatch::Request.newenvifpolicy=request.content_security_policynonce=request.content_security_policy_noncenonce_directives=request.content_security_policy_nonce_directivescontext=request.controller_instance||requestheaders[header_name(request)] =policy.build(context,nonce,nonce_directives)endresponseend